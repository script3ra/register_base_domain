# Base Domain Register

Асинхронный Python инструмент для регистрации доменов `.base.eth` в сети Base с использованием множественных кошельков.

## Возможности

- **Асинхронные операции**: Построен на `asyncio` и `aiohttp` для высокой производительности
- **Поддержка множественных кошельков**: Обработка нескольких кошельков из seed-фраз или приватных ключей
- **Умная генерация доменов**: Случайная генерация имен доменов с комбинациями имен
- **Оптимизация газа**: Автоматическая оценка газа и расчет приоритетных комиссий
- **Параллельная обработка**: Настраиваемые лимиты потоков для параллельной регистрации доменов
- **Обработка ошибок**: Надежная обработка ошибок с детальным логированием

## Установка

0. Установите **python 3.11+** с https://www.python.org/downloads/
1. Клонируйте репозиторий
2. Установите зависимости:
```bash
pip install -r requirements.txt
```

## Конфигурация

Отредактируйте константы конфигурации в `main.py`:

```python
CHAIN_NAME = "base"
CHAIN_ID = 8453
RPC_ENDPOINT = "https://base.llamarpc.com"
MAX_REGISTER_DOMAIN = 4      # Максимальное количество доменов на кошелек
MAX_THREAD = 1               # Максимальное количество одновременных операций
```

## Использование

### 1. Подготовка данных кошелька

Создайте файл `wallet_data.txt` с информацией о ваших кошельках:

```
# Seed-фразы (12+ слов)
слово1 слово2 слово3 ... слово12
другая seed-фраза здесь

# Или приватные ключи
0x1234567890abcdef...
0xabcdef1234567890...

# Или seed-фразы (12+ слов) и приватные ключи (смешанно)
0x1234567890abcdef...
слово1 слово2 слово3 ... слово12
0xabcdef1234567890...
```

### 2. Запуск скрипта

```bash
python main.py
```

## Как это работает

### Обработка кошельков
- **Seed-фразы**: Автоматически выводит приватные ключи используя стандарты BIP32/BIP44
- **Приватные ключи**: Прямое использование для немедленной обработки
- **Генерация адресов**: Создает checksum адреса для каждого кошелька

### Процесс регистрации доменов
1. **Проверка доменов**: Проверяет текущее количество доменов для каждого кошелька
2. **Генерация имен**: Создает случайные имена доменов используя комбинации имен и фамилий
3. **Проверка доступности**: Проверяет доступность домена в блокчейне
4. **Создание транзакции**: Строит транзакцию регистрации с данными резолвера
5. **Оценка газа**: Вычисляет оптимальные параметры газа
6. **Подпись транзакции**: Подписывает и отправляет транзакцию
7. **Логирование результатов**: Записывает успех/неудачу с хешем транзакции

### Асинхронная архитектура
- **HTTP сессии**: Переиспользуемые aiohttp сессии для API вызовов
- **Web3 интеграция**: AsyncWeb3 для неблокирующих блокчейн операций
- **Контроль конкурентности**: Ограничение потоков на основе семафоров
- **Параллельная обработка**: Несколько кошельков обрабатываются одновременно

## Структура классов

### `AggregateWallet`
Управляет выводом ключей кошелька:
- `aggregate_seed()`: Выводит ключи из seed-фраз
- `aggregate_private_key()`: Обрабатывает прямые приватные ключи
- `get_private_key()`: Универсальный метод извлечения ключей

### `AsyncBaseDomainRegister`
Основной класс регистрации доменов:
- `get_all_domains()`: Получает существующие домены через API
- `check_available_domain()`: Проверка доступности в блокчейне
- `build_tx()`: Создание транзакции с данными резолвера
- `sign_tx()`: Подпись и отправка транзакции
- `buy_base_domain()`: Полный рабочий процесс регистрации

## API эндпоинты

- **Base Names API**: `https://www.base.org/api/basenames/getUsernames`
- **RPC эндпоинт**: `https://base.llamarpc.com`

## Смарт-контракты

- **Контроллер регистратора**: `0x4cCb0BB02FCABA27e82a56646E81d8c5bC4119a5`
- **L2 резолвер**: `0x4cCb0BB02FCABA27e82a56646E81d8c5bC4119a5`

## Зависимости

- `web3~=7.8.0`: Ethereum Web3 библиотека
- `aiohttp~=3.9.1`: Асинхронный HTTP клиент
- `eth-account~=0.13.7`: Управление Ethereum аккаунтами
- `mnemonic~=0.21`: Обработка BIP39 мнемоник
- `bip32utils~=0.3.post4`: Вывод BIP32 ключей
- `eth-keys~=0.6.1`: Операции с Ethereum ключами
- `loguru~=0.7.3`: Продвинутое логирование

## Обработка ошибок

Система включает комплексную обработку ошибок:
- Обнаружение неверных данных кошелька
- Сбои сетевых соединений
- Неудачные транзакции
- Ошибки оценки газа
- Проблемы с доступностью доменов

## Особенности производительности

- **Асинхронный I/O**: Неблокирующие операции
- **Пул соединений**: Переиспользование HTTP сессий
- **Пакетная обработка**: Несколько кошельков обрабатываются параллельно
- **Управление ресурсами**: Автоматическая очистка соединений

## Особенности безопасности

- **Защита приватных ключей**: Ключи никогда не логируются и не раскрываются
- **Безопасный вывод**: Генерация ключей совместимая с BIP32/BIP44
- **Валидация транзакций**: Проверка операций в блокчейне

## Логирование

Комплексное логирование используя Loguru:
- Уведомления об успехе/неудаче
- Хеши транзакций
- Детали ошибок
- Метрики производительности

## Пример вывода

```
[INFO] Loading: 3 wallet. Run script of 1 thread...
[SUCCESS] [0x1234...] Success buy domain: johnsmith1990.base.eth | Hash: 0xabcd...
[SUCCESS] [0x5678...] Success buy domain: janedoe1985.base.eth | Hash: 0xefgh...
[INFO] Registration completed. Successful: 2, Failed: 0
```

## Лицензия

Этот проект лицензирован под MIT License.

## Отказ от ответственности

Этот инструмент предназначен только для образовательных и законных целей. 